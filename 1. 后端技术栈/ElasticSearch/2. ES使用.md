* 主要学习和分享在Kibana中操作ES，包括集群管理，命令字使用，以及ES索引结构字段的解释等

# 1、开发者工具
  * ![开发者工具](images/development_tools.png "")
  * 在开发者工具中执行API和在Postman中执行API效果一样

  * ES常用命令(常用API) 
  *     # Query all index
        GET /_cat/indices

        health	status	index	 uuid	pri	rep	docs.count	docs.deleted	store.size	pri.store.size	dataset.size
        green	open	.internal.alerts-transform.health.alerts-default-000001	jEFgSG1WRn6tmKOp9MR4Tg	1	0	0	0	249b 	   249b 	  249b
        green	open	.internal.alerts-observability.logs.alerts-default-000001	Wb4b386CTWCchvt1ZYafrQ	1	0	0	0	249b 	   249b 	  249b
        green	open	.internal.alerts-observability.uptime.alerts-default-000001	frPfDWZ5RVmDUccrWnEXjg	1	0	0	0	249b 	   249b 	  249b
        yellow	open	products_index	lEP6sV_XQYyxl0tyyh3I0g	1	1	0	0	249b 	   249b 	  249b
        green	open	.internal.alerts-ml.anomaly-detection.alerts-default-000001	emGcxX_SQpyZnffgKIA5MQ	1	0	0	0	249b 	   249b 	  249b
        green	open	.internal.alerts-observability.slo.alerts-default-000001	J3o3__t8RiWBD03a4n-2uw	1	0	0	0	249b 	   249b 	  249b
        green	open	.internal.alerts-default.alerts-default-000001	I-uxFmPlRLKzwh_oM_6OXA	1	0	0	0	249b 	   249b 	  249b
        green	open	.internal.alerts-observability.apm.alerts-default-000001	NF7rjxHxR86khsP1XIwEjg	1	0	0	0	249b 	   249b 	  249b
        green	open	.internal.alerts-observability.metrics.alerts-default-000001	_Hmouzc7TvyasQn8Z1K34Q	1	0	0	0	249b 	   249b 	  249b
        green	open	.kibana-observability-ai-assistant-conversations-000001	_pxGYKukQWq4VF9SbaQuGA	1	0	0	0	249b 	   249b 	  249b
        green	open	.internal.alerts-ml.anomaly-detection-health.alerts-default-000001	sn7SeT86QUOhirAp4nNB1Q	1	0	0	0	249b 	   249b 	  249b
        green	open	.internal.alerts-observability.threshold.alerts-default-000001	Ap7-51-wTnKS5ERCWpwRIQ	1	0	0	0	249b 	   249b 	  249b
        green	open	.internal.alerts-security.alerts-default-000001	z6INliOeQQSz9YRB2sKdqQ	1	0	0	0	249b 	   249b 	  249b
        green	open	.kibana-observability-ai-assistant-kb-000001	FwKjgwOFQ6-pNiS3dDPDkg	1	0	0	0	249b 	   249b 	  249b
        green	open	.internal.alerts-stack.alerts-default-000001	t2DsDUduQvKuGHyRh-JbPA	1	0	0	0	249b 	   249b 	  249b
        
        _cat命令字下，还有很多子命令字，可以自行查阅，这里详细解释 _cat/indices命令字: 该命令字将返回当前集群中所有的索引列表，包括一些集群内部使用的索引，列含义如下：
        green/yellow/red: 
        green —— 最健康的状态，代表所有的主分片和副本分片都可用；
        yellow —— 所有的主分片可用，但是部分副本分片不可用；
        red —— 部分主分片不可用。（此时执行查询部分数据仍然可以查到，遇到这种情况，还是赶快解决比较好。)
        比如上面的执行结果中，products_index 这个索引是yellow，这是因为TODO
        
    |title| description |
    |  :----  | :----  |
    | health |	索引的健康状态 |
    | status |	索引的开启状态 |
    | index |	索引名字 |
    | uuid |	索引的uuid |
    | pri |	索引的主分片数量 |
    | rep |索引的复制分片数量 |
    | docs.count |索引下的文档总数 |
    | docs.deleted | 索引下删除状态的文档数 |
    | store.size | 主分片+复制分片的大小 |
    | pri.store.size |	主分片的大小 |
    | pri.store.size |	主分片的大小 |
    | dataset.size | TODO |
# Welcome to the Dev Tools Console!
#
# You can use Console to explore the Elasticsearch API. See the Elasticsearch API reference to learn more:
# https://www.elastic.co/guide/en/elasticsearch/reference/current/rest-apis.html
#
# Here are a few examples to get you started.

# Query all index  format=json/text/ymal
GET /_cat/indices?format=text

# Query idnex info
GET /products_index/_settings

# DELETE idnex
# DELETE /products_index_new

# Create an index
PUT /products_index
{
  "settings": {
    "number_of_shards":5,
    "number_of_replicas":3
  },
  "mappings": {
      "properties": {
        "id": {"type":"integer"},
        "name":{"type":"text"}
      }
  }
}

# Insert data
POST /products_index/_doc
{
  "id": 2,
  "name": "TELCO TOPUP"
}

# Get data
GET /products_index/_search

# modify replica numbers
PUT /products_index/_settings
{
  "index": {
    "number_of_replicas":2
  }
}

# modify shards numbers
# ES不能动态修改分片数，如果需要修改分片，步骤如下
# 1.新建索引并设置相应的分片数-> 2.将旧索引数据复制到新索引 -> 3.删除旧索引 -> 4.将新索引设置一个别名，别名和旧索引名字一模一样
# 1.
PUT /products_index_new
{
  "settings": {
    "number_of_shards":3,
    "number_of_replicas":2
  },
  "mappings": {
      "properties": {
        "id": {"type":"integer"},
        "name":{"type":"text"}
      }
  }
}
# 2.
POST _reindex
{
  "source": {
    "index": "products_index"
  },
  "dest": {
    "index": "products_index_new"
  }
}
# 检查新索引，确保数据拷贝成功了
GET /products_index_new/_search
# 3.
DELETE products_index   
# 4.
PUT products_index_new/_alias/products_index
# 5. 用新索引名字，和就索引名字，都可以查询了
GET /products_index/_search

# Add a document to my-index
POST /my-index/_doc
{
    "id": "park_rocky-mountain",
    "title": "Rocky Mountain",
    "description": "Bisected north to south by the Continental Divide, this portion of the Rockies has ecosystems varying from over 150 riparian lakes to montane and subalpine forests to treeless alpine tundra."
}


# Perform a search in my-index
GET /my-index/_search?q="rocky mountain"